pipeline {
  agent any
  parameters {
    string(name : 'BUILD_DOCKER_IMAGE', defaultValue : 'Y', description : 'Enable docker image build')
    string(name : 'PUSH_DOCKER_IMAGE', defaultValue : 'Y', description : 'Enable docker image build')
    string(name : 'AWS_ACCOUNT_ID', defaultValue : '657976307134', description : 'AWS account id')
    string(name : 'ECR_REPO_NAME', defaultValue : 'demo_python', description : 'AWS account id')
    string(name : 'ECR_REPO_TAG', defaultValue : 'latest', description : 'AWS account id')
  }

  environment {
    DOCKER_IAMGE: "${params.AWS_ACCOUNT_ID}.dkr.ecr.ap-northeast-2.amazonaws.com/${params.ECR_REPO_NAME}:${params.ECR_REPO_TAG}"
  }

  stages {
    stage('============ Build Docker Image ============') {
        when {
            expression {
              return params.BUILD_DOCKER_IMAGE == 'Y'
            }
        }
        steps {
            echo "Current workspace is ${env.WORKSPACE}"
        }
    }
    stage('============ Deploy Docker Image ============') {
        when {
            expression {
              return params.PUSH_DOCKER_IMAGE == 'Y'
            }
        }
        steps {
            echo "Depeloy Docker Image :: ${DOCKER_IAMGE}"
        }
    }
  }
}